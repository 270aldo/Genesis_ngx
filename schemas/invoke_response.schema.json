{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://genesis-ngx.com/schemas/invoke_response.schema.json",
  "title": "InvokeResponse",
  "description": "Schema for agent invocation responses in Genesis NGX",
  "type": "object",
  "required": ["agent_id", "session_id", "response", "status"],
  "properties": {
    "agent_id": {
      "type": "string",
      "description": "Agent that handled the request",
      "enum": [
        "genesis_x",
        "blaze",
        "atlas",
        "tempo",
        "wave",
        "sage",
        "metabol",
        "macro",
        "nova",
        "spark",
        "stella",
        "luna",
        "logos"
      ]
    },
    "session_id": {
      "type": "string",
      "description": "Session/conversation ID",
      "format": "uuid"
    },
    "response": {
      "type": "string",
      "description": "Agent's response text",
      "minLength": 1
    },
    "events": {
      "type": "array",
      "description": "Execution events (tool calls, intermediate steps)",
      "items": {
        "type": "object",
        "properties": {
          "type": {
            "type": "string",
            "enum": ["output", "chunk", "tool_call", "tool_result", "mock", "error"]
          },
          "content": {
            "type": ["string", "object"]
          },
          "timestamp": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["type", "content"]
      },
      "default": []
    },
    "tokens_used": {
      "type": "integer",
      "description": "Total tokens consumed",
      "minimum": 0,
      "default": 0
    },
    "cost_usd": {
      "type": "number",
      "description": "Cost in USD for this invocation",
      "minimum": 0,
      "default": 0.0
    },
    "latency_ms": {
      "type": "number",
      "description": "Response latency in milliseconds",
      "minimum": 0,
      "default": 0.0
    },
    "status": {
      "type": "string",
      "description": "Invocation status",
      "enum": ["success", "error", "timeout", "budget_exceeded"]
    },
    "error": {
      "type": ["object", "null"],
      "description": "Error details if status is not success",
      "properties": {
        "code": {
          "type": "integer",
          "description": "JSON-RPC error code"
        },
        "message": {
          "type": "string"
        },
        "data": {
          "type": "object"
        }
      }
    },
    "metadata": {
      "type": "object",
      "description": "Additional response metadata",
      "properties": {
        "model": {
          "type": "string",
          "description": "Gemini model used"
        },
        "specialist_invoked": {
          "type": ["string", "null"],
          "description": "Specialist agent invoked by orchestrator"
        },
        "tools_used": {
          "type": "array",
          "items": {"type": "string"}
        }
      },
      "additionalProperties": true
    }
  },
  "additionalProperties": false,
  "examples": [
    {
      "agent_id": "genesis_x",
      "session_id": "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
      "response": "I've routed your request to BLAZE, our strength training specialist. Here's a personalized hypertrophy program...",
      "events": [
        {"type": "tool_call", "content": {"name": "invoke_specialist", "args": {"agent": "blaze"}}},
        {"type": "tool_result", "content": {"status": "success"}}
      ],
      "tokens_used": 1250,
      "cost_usd": 0.0156,
      "latency_ms": 2340.5,
      "status": "success",
      "metadata": {
        "model": "gemini-2.5-pro",
        "specialist_invoked": "blaze",
        "tools_used": ["classify_intent", "invoke_specialist"]
      }
    },
    {
      "agent_id": "blaze",
      "session_id": "6ba7b810-9dad-11d1-80b4-00c04fd430c8",
      "response": "Based on your 8 reps at 80kg, your estimated 1RM is approximately 98kg using the Brzycki formula.",
      "tokens_used": 450,
      "cost_usd": 0.0045,
      "latency_ms": 890.2,
      "status": "success",
      "metadata": {
        "model": "gemini-2.5-flash",
        "tools_used": ["calculate_1rm"]
      }
    }
  ]
}
